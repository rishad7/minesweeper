<div class="container mx-auto">
    <div class="flex flex-col items-center">
        <div style="border: 5px solid #c6c6c6;">
            <div style="width: 360px;display: flex;flex-direction: row;background-color: #c6c6c6;padding: 20px;">
                <div style="color: red;font-size: 32px;width: 40%;"><%= $mine_count %></div>
                <div style="width: 20%;display: flex; justify-content: center;align-items: center;">
                    <div style="height: 48px;width: 48px;">
                        <% if $game_status == 'start' %>
                            <%= image_tag("/assets/icons/face_start.svg") %>
                        <% elsif $game_status == 'lose' %>
                            <%= image_tag("/assets/icons/face_lose.svg") %>
                        <% else %>
                            <%= image_tag("/assets/icons/face_won.svg") %>
                        <% end %>
                    </div>
                </div>
                <div style="color: red;font-size: 32px;width: 40%;text-align: right;"><%= $timer %></div>
            </div>
            <div style="width: 360px;" class="game-board flex flex-wrap">
                <% for i in 0..$row_count - 1 do %>
                    <% for j in 0..$column_count - 1 do %>
                        <div class="w-10 h-10 border">
                            <% if $game_status == 'start' %>
                                <a href='<%= "/#{i}/#{j}"  %>'>
                                    <% if !@game_board[i][j][:is_open] %>
                                        <%= image_tag("/assets/icons/closed.svg") %>
                                    <% else %>
                                        <% if @game_board[i][j][:content] == '' %>
                                            <%= image_tag("/assets/icons/open.svg") %>
                                        <% elsif @game_board[i][j][:content] == 'flag' %>
                                            <%= image_tag("/assets/icons/flag.svg") %>
                                        <% elsif @game_board[i][j][:content] == 'bomb_exploded' %>
                                            <%= image_tag("/assets/icons/bomb_exploded.svg") %>
                                        <% elsif @game_board[i][j][:content] == 'bomb' %>
                                            <%= image_tag("/assets/icons/bomb.svg") %>
                                        <% elsif @game_board[i][j][:content] == 'number' %>
                                            <div class="relative h-full w-full flex items-center justify-center">
                                                <p class="z-10 font-black text-2xl text-color-<%= @game_board[i][j][:value] %>"><%= @game_board[i][j][:value] %></p>
                                                <%= image_tag("/assets/icons/open.svg", class: "absolute") %>
                                            </div>
                                        <% end %>
                                    <% end %>
                                </a>
                            <% else %>
                                <div>
                                    <% if !@game_board[i][j][:is_open] %>
                                        <%= image_tag("/assets/icons/closed.svg") %>
                                    <% else %>
                                        <% if @game_board[i][j][:content] == '' %>
                                            <%= image_tag("/assets/icons/open.svg") %>
                                        <% elsif @game_board[i][j][:content] == 'flag' %>
                                            <%= image_tag("/assets/icons/flag.svg") %>
                                        <% elsif @game_board[i][j][:content] == 'bomb_exploded' %>
                                            <%= image_tag("/assets/icons/bomb_exploded.svg") %>
                                        <% elsif @game_board[i][j][:content] == 'bomb' %>
                                            <%= image_tag("/assets/icons/bomb.svg") %>
                                        <% elsif @game_board[i][j][:content] == 'number' %>
                                            <div class="relative h-full w-full flex items-center justify-center">
                                                <p class="z-10 font-black text-2xl text-color-<%= @game_board[i][j][:value] %>"><%= @game_board[i][j][:value] %></p>
                                                <%= image_tag("/assets/icons/open.svg", class: "absolute") %>
                                            </div>
                                        <% end %>
                                    <% end %>
                                </div>
                            <% end %>
                        </div>
                    <% end %>
                <% end %>
            </div>
        </div>
    </div>
    <% if $game_status == 'lose' %>
        <div class="flex flex-col items-center">
            <div style="padding: 20px;margin-top: 20px;" class="border flex flex-col">
                <div>Time: <span class="font-bold"><%= $timer %></span> sec</div>
                <div>Clicks: <%= $click %></div>
            </div>
        </div>
    <% end %>
    <% if $game_status == 'won' %>
        
        

        <%= form_with(model: @result) do |form| %>
            <% if @result.errors.any? %>
                <div id="error_explanation">
                <h2><%= pluralize(@result.errors.count, "error") %> prohibited this result from being saved:</h2>

                <ul>
                    <% @result.errors.each do |error| %>
                    <li><%= error.full_message %></li>
                    <% end %>
                </ul>
                </div>
            <% end %>

            <div class="field">
                <%= form.label :name %>
                <%= form.text_field :name %>
            </div>

            <%= form.hidden_field :clicks, value: $click %>
            <%= form.hidden_field :time_taken, value: $timer %>
            <%= form.hidden_field :game_board, value: "" %>
            <%= form.hidden_field :high_score, value: @high_score  %>

            <div class="actions">
                <%= form.submit "Submit" %>
            </div>
        <% end %>



    <% end %>
</div>